### **TASK: AL-03**

#### **Title:**
Architectural Pruning: Isolate Core Server and Deprecate Legacy Tools

#### **Context:**
As part of our "Lock-In and Advance" development methodology, we are architecting a new suite of high-level, workflow-driven tools (`plan_task`, `implement_task`, etc.). To prevent confusion for both human developers and AI agents, we must first isolate the core MCP server and deprecate the existing, now-obsolete workflow tools (`begin_task`, `submit_work`, `approve_and_handoff`, etc.). This task will comment out all legacy tools, leaving only the essential `initialize_project` tool active. This creates a clean, controlled environment for us to incrementally introduce and test our new commands.

#### **Implementation Details:**
1.  **Locate the main server file.** All work will be done in `src/alfred/server.py`.
2.  **Preserve `initialize_project`.** The `initialize_project` tool is fundamental to setting up a new project and must remain fully functional. Do not modify its code or docstring.
3.  **Comment out all other tool definitions.** Systematically go through the file and comment out every `@app.tool()` decorator and the function definition that follows it, for every tool *except* `initialize_project`. Use Python block comments (`"""..."""`) to wrap the entire function, from the decorator to the last line of the function body.
4.  **Comment out associated imports.** At the top of the file, locate the `import` statements that bring in the implementation logic for the deprecated tools (e.g., `from src.alfred.tools.task_tools import begin_task as begin_task_impl`). Comment out these lines.

**Dev Notes:**
*   We are **commenting out**, not deleting. This is a deliberate choice. The code within these old tools contains valuable logic patterns (like how `submit_work` interacts with the orchestrator) that we may want to reference when building our new tools. Commenting preserves this code as a non-executable reference.
*   The goal is to have a `server.py` file that, when run, exposes only a single tool to the MCP client: `mcp__alfred__initialize_project`. All other tools should be completely hidden.

**Files to Modify:**

1.  **`src/alfred/server.py`:**
    ```python
    # src/alfred/server.py
    
    # ... other imports ...
    from src.alfred.lib.transaction_logger import transaction_logger
    from src.alfred.models.schemas import ToolResponse
    from src.alfred.tools.initialize import initialize_project as initialize_project_impl
    # --- COMMENT OUT THE FOLLOWING IMPORTS ---
    # from src.alfred.tools.progress_tools import mark_step_complete as mark_step_complete_impl
    # from src.alfred.tools.review_tools import approve_and_advance_stage as approve_and_advance_stage_impl
    # from src.alfred.tools.review_tools import approve_and_handoff as approve_and_handoff_impl
    # from src.alfred.tools.review_tools import provide_review as provide_review_impl
    # from src.alfred.tools.task_tools import begin_task as begin_task_impl
    # from src.alfred.tools.task_tools import submit_work as submit_work_impl
    
    app = FastMCP(settings.server_name)
    
    
    @app.tool()
    async def initialize_project(provider: str | None = None) -> ToolResponse:
        """
        [... KEEP THIS TOOL'S DOCSTRING AND CODE UNCHANGED ...]
        """
        tool_name = inspect.currentframe().f_code.co_name
        request_data = {"provider": provider} if provider else {}
        response = initialize_project_impl(provider)
        transaction_logger.log(task_id=None, tool_name=tool_name, request_data=request_data, response=response)
        return response
    
    
    # --- USE BLOCK COMMENTS FOR ALL SUBSEQUENT TOOLS ---
    """
    @app.tool()
    async def begin_task(task_id: str) -> ToolResponse:
        '''
        [... docstring ...]
        '''
        tool_name = inspect.currentframe().f_code.co_name
        request_data = {"task_id": task_id}
        response = begin_task_impl(task_id)
        transaction_logger.log(task_id=task_id, tool_name=tool_name, request_data=request_data, response=response)
        return response
    """
    
    # --- REPEAT THIS PATTERN FOR submit_work, provide_review, etc. ---
    
    # ...
    
    if __name__ == "__main__":
        app.run()
    ```

#### **Acceptance Criteria:**
*   The `src/alfred/server.py` file has been modified.
*   The `@app.tool()` decorator and function for `initialize_project` are untouched and fully active.
*   All other `@app.tool()` decorators and their corresponding functions (`begin_task`, `submit_work`, `provide_review`, `approve_and_handoff`, `approve_and_advance_stage`, `mark_step_complete`) are fully commented out using block comments.
*   The import statements for the implementation logic of the commented-out tools are also commented out.

#### **AC Verification:**
*   Run the MCP server (`python src/alfred/server.py`).
*   Connect to it with an MCP client (e.g., Cursor, Claude Code).
*   Run the command to list available tools (e.g., `/mcp` or a client-specific command).
*   **Confirm** that the only tool listed for the `alfred` server is `mcp__alfred__initialize_project`. No other tools should be visible.

#### **Unit Tests:**
*   No new unit tests are required for this task, as it is a deprecation action.
*   Existing tests related to the deprecated tools are expected to fail or be skipped. These will be deleted in a subsequent cleanup task once the new architecture is fully in place.
